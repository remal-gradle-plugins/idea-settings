name: Automatic release

on:
  schedule:
  - cron: '23 17 * * 2'
  workflow_dispatch: { }

defaults:
  run:
    shell: bash

jobs:
  automatic-release:
    name: Automatic release
    runs-on: ubuntu-latest
    timeout-minutes: 15
    concurrency: automatic-release
    steps:
    - name: Automatic release
      uses: remal-github-actions/automatic-release@v1
      with:
        dryRun: 'true'
        versionIncrementMode: 'patch'
        versionTagPrefix: 'v'
        expectedFilesToChange: |
          gradle-plugin-api-dependencies.txt
        allowedCommitPrefixes: |
          [push-back]
        allowedPullRequestLabels: |
          dependencies
          sync-with-template
